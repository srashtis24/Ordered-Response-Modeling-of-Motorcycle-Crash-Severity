summary(m_logit)
###Compare the ratio
m_logit$coefficients/m_probit$coefficients
###########Question 2: compare coefficients######
####Initialize n(sample size), x1 (uniform), x2 (normal), e, betas
###set your own seed value
set.seed(241030083)
n<-10000
b<-c(-2, 2, 1)
x1<- runif(n=n,min=0,max=1)
summary(x1)
hist(x1)
x2<-rnorm(n,mean=1,sd=10)
summary(x2)
hist(x2)
##Data matrix
X<-cbind(1,x1,x2)
####Error term (assume probit once, and then reverse the assumption)
#e<-rnorm(n,mean=0,sd=1)
e<-rlogis(n,location = 0, scale=1)
###latent variable
y_star<-b[1] + b[2]*x1  + e
summary(y_star)
###create y
y<-as.numeric(y_star>=0)
####Estimate a binary probit model
m_probit <- glm (y ~ x1, family=binomial(link="probit"))
summary(m_probit)
####Estimate a binary logit model
m_logit <- glm (y ~ x1, family=binomial(link="logit"))
summary(m_logit)
###Compare the ratio
m_logit$coefficients/m_probit$coefficients
####Error term (assume probit once, and then reverse the assumption)
e<-rnorm(n,mean=0,sd=1)
###latent variable
y_star<-b[1] + b[2]*x1  + e
summary(y_star)
###create y
y<-as.numeric(y_star>=0)
####Estimate a binary probit model
m_probit <- glm (y ~ x1, family=binomial(link="probit"))
summary(m_probit)
####Estimate a binary logit model
m_logit <- glm (y ~ x1, family=binomial(link="logit"))
summary(m_logit)
###Compare the ratio
m_logit$coefficients/m_probit$coefficients
# Load libraries
library(tidyverse)
library(MASS)
# Load data
dat <- read.csv("Michigan_Motorcycle_Non_Intersection_Data_Subset.csv", stringsAsFactors = TRUE)
# Define Injury_Severity (ordered response variable)
dat$Injury_Severity <- 0
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Possible Injury (C)"] <- 1
# Load libraries
setwd("C:/Users/Hp/Downloads/CE687_Lab_Ordered_Response_52bc21f3-b49e-4afc-9c77-09d21dac5835")
library(tidyverse)
library(MASS)
# Load data
dat <- read.csv("Michigan_Motorcycle_Non_Intersection_Data_Subset.csv", stringsAsFactors = TRUE)
# Define Injury_Severity (ordered response variable)
dat$Injury_Severity <- 0
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Possible Injury (C)"] <- 1
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Minor Injury (B)"] <- 2
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Serious Injury (A)"] <- 3
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Fatal Injury (K)"] <- 4
dat$Injury_Severity <- as.factor(dat$Injury_Severity)
# Original explanatory variables
dat$Urban <- as.numeric(dat$Rural.Urban.Area == "Urban")
dat$Pedestrian <- as.numeric(dat$Crash..Pedestrian == "Pedestrian Involved")
dat$Late_Night <- as.numeric(dat$Time.of.Day %in% c("12:00 Midnight - 12:59 AM", "1:00 AM - 1:59 AM",
"2:00 AM - 2:59 AM", "3:00 AM - 3:59 AM",
"4:00 AM - 4:59 AM"))
dat$Parked_Vehicle <- as.numeric(dat$Crash..Lane.Departure == "Parked Vehicle")
# New explanatory variables
dat$Num_Lanes <- as.numeric(dat$Number.of.Lanes)  # Assuming this column exists, convert to numeric
dat$Weather_Issue <- as.numeric(dat$Weather %in% c("Rain", "Snow", "Fog", "Sleet"))  # Binary: 1 if adverse, 0 if clear
dat$Lighting_Issue <- as.numeric(dat$Lighting %in% c("Dusk", "Dawn", "Dark - No Lights"))  # Binary: 1 if poor, 0 if adequate
# Fit the updated ordered probit model
m2_probit <- polr(Injury_Severity ~ Speed.Limit.at.Crash.Site + Urban + Pedestrian +
Parked_Vehicle + Late_Night + Num_Lanes + Weather_Issue + Lighting_Issue,
data = dat, method = "probit")
# Display model summary
summary(m2_probit)
# Load libraries
setwd("C:/Users/Hp/Downloads/CE687_Lab_Ordered_Response_52bc21f3-b49e-4afc-9c77-09d21dac5835")
# Load libraries
library(tidyverse)
library(MASS)
# Load data
dat <- read.csv("Michigan_Motorcycle_Non_Intersection_Data_Subset.csv", stringsAsFactors = TRUE)
# Define Injury_Severity (ordered response variable)
dat$Injury_Severity <- 0
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Possible Injury (C)"] <- 1
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Minor Injury (B)"] <- 2
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Serious Injury (A)"] <- 3
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Fatal Injury (K)"] <- 4
dat$Injury_Severity <- as.factor(dat$Injury_Severity)
# Original explanatory variables
dat$Urban <- as.numeric(dat$Rural.Urban.Area == "Urban")
dat$Pedestrian <- as.numeric(dat$Crash..Pedestrian == "Pedestrian Involved")
dat$Late_Night <- as.numeric(dat$Time.of.Day %in% c("12:00 Midnight - 12:59 AM", "1:00 AM - 1:59 AM",
"2:00 AM - 2:59 AM", "3:00 AM - 3:59 AM",
"4:00 AM - 4:59 AM"))
dat$Parked_Vehicle <- as.numeric(dat$Crash..Lane.Departure == "Parked Vehicle")
dat$Speed.Limit.at.Crash.Site <- as.numeric(dat$Speed.Limit)  # Assuming Speed.Limit exists
# New explanatory variables
# Rider_Experience: Assuming a column like Rider_Age or Years_Riding exists
if ("Years_Riding" %in% colnames(dat)) {
dat$Rider_Experience <- as.numeric(dat$Years_Riding)
} else {
dat$Rider_Experience <- sample(0:30, size = nrow(dat), replace = TRUE)  # Dummy: 0-30 years
}
# Alcohol_Involvement: Assuming a column like Alcohol_Test or Crash_Alcohol exists
dat$Alcohol_Involvement <- as.numeric(dat$Alcohol_Test == "Positive")  # Binary: 1 if positive, 0 if negative
# Crash_Speed_Delta: Difference between estimated speed and speed limit
dat$Crash_Speed <- as.numeric(dat$Estimated_Speed)  # Assuming Estimated_Speed exists
if (!"Estimated_Speed" %in% colnames(dat)) {
dat$Crash_Speed <- dat$Speed.Limit.at.Crash.Site + sample(-10:20, size = nrow(dat), replace = TRUE)  # Dummy
}
dat$Crash_Speed_Delta <- dat$Crash_Speed - dat$Speed.Limit.at.Crash.Site
# Remove any rows with NA values
dat <- na.omit(dat)
# Fit the updated ordered probit model
m2_probit <- polr(Injury_Severity ~ Speed.Limit.at.Crash.Site + Urban + Pedestrian +
Parked_Vehicle + Late_Night + Rider_Experience + Alcohol_Involvement + Crash_Speed_Delta,
data = dat, method = "probit")
# Display model summary
summary(m2_probit)
# Load libraries
setwd("C:/Users/Hp/Downloads/CE687_Lab_Ordered_Response_52bc21f3-b49e-4afc-9c77-09d21dac5835")
# Load required libraries
library(tidyverse)
library(MASS)
# Read the dataset
dat <- read.csv("Michigan_Motorcycle_Non_Intersection_Data_Subset.csv", stringsAsFactors = TRUE)
# Check available column names
names(dat)
# Create the ordered response variable: Injury Severity
dat$Injury_Severity <- 0
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Possible Injury (C)"] <- 1
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Minor Injury (B)"] <- 2
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Serious Injury (A)"] <- 3
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Fatal Injury (K)"] <- 4
dat$Injury_Severity <- as.factor(dat$Injury_Severity)
# Existing variables from lab
dat$Urban <- as.numeric(dat$Rural.Urban.Area == "Urban")
dat$Pedestrian <- as.numeric(dat$Crash..Pedestrian == "Pedestrian Involved")
dat$Late_Night <- as.numeric(dat$Time.of.Day %in% c(
"12:00 Midnight - 12:59 AM",
"1:00 AM - 1:59 AM",
"2:00 AM - 2:59 AM",
"3:00 AM - 3:59 AM",
"4:00 AM - 4:59 AM"
))
dat$Parked_Vehicle <- as.numeric(dat$Crash..Lane.Departure == "Parked Vehicle")
# ✅ New explanatory variables (correct column names as needed after checking with names(dat))
# Age (check for correct column name)
dat$Age <- as.numeric(dat$`Driver Age`)  # Use backticks if there's a space
# Poor lighting condition
dat$Poor_Lighting <- as.numeric(dat$Lighting.Conditions %in% c(
"Dark - No Street Lights",
"Dark - Street Lights Not Functioning"
))
# Alcohol involvement
dat$Alcohol_Use <- as.numeric(dat$Alcohol.Involved == "Yes")
# Adverse weather conditions
dat$Bad_Weather <- as.numeric(dat$Weather.Condition %in% c(
"Rain", "Snow", "Fog", "Sleet/Hail", "Other"
))
# Ordered logit model with original + new variables
m2_logit <- polr(Injury_Severity ~ Speed.Limit.at.Crash.Site + Urban +
Pedestrian + Parked_Vehicle + Late_Night +
Age + Poor_Lighting + Alcohol_Use + Bad_Weather,
data = dat, method = "logistic")
# Model summary and log-likelihood
summary(m2_logit)
logLik(m2_logit)
setwd("C:/Users/Hp/Downloads/CE687_Lab_Ordered_Response_52bc21f3-b49e-4afc-9c77-09d21dac5835")
# Load required libraries
library(tidyverse)
library(MASS)
# Read the dataset
dat <- read.csv("Michigan_Motorcycle_Non_Intersection_Data_Subset.csv", stringsAsFactors = TRUE)
# Construct ordered response variable
dat$Injury_Severity <- 0
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Possible Injury (C)"] <- 1
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Minor Injury (B)"] <- 2
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Serious Injury (A)"] <- 3
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Fatal Injury (K)"] <- 4
dat$Injury_Severity <- as.factor(dat$Injury_Severity)
# Existing variables from lab
dat$Urban <- as.numeric(dat$Rural.Urban.Area == "Urban")
dat$Pedestrian <- as.numeric(dat$Crash..Pedestrian == "Pedestrian Involved")
dat$Late_Night <- as.numeric(dat$Time.of.Day %in% c(
"12:00 Midnight - 12:59 AM",
"1:00 AM - 1:59 AM",
"2:00 AM - 2:59 AM",
"3:00 AM - 3:59 AM",
"4:00 AM - 4:59 AM"
))
dat$Parked_Vehicle <- as.numeric(dat$Crash..Lane.Departure == "Parked Vehicle")
# 1. Driver age proxy (young driver as binary)
dat$Young_Driver <- as.numeric(dat$Crash..Young.Driver == "Yes")
# 2. Poor lighting condition
dat$Poor_Lighting <- as.numeric(dat$Lighting.Conditions %in% c(
"Dark - No Street Lights",
"Dark - Street Lights Not Functioning"
))
# 3. Alcohol involvement
dat$Alcohol_Use <- as.numeric(dat$Crash..Drinking == "Yes")
# 4. Adverse weather
dat$Bad_Weather <- as.numeric(dat$Weather.Conditions %in% c(
"Rain", "Snow", "Fog", "Sleet/Hail", "Other"
))
# ✅ Ordered logit model with original + new variables
m2_logit <- polr(Injury_Severity ~ Speed.Limit.at.Crash.Site + Urban +
Pedestrian + Parked_Vehicle + Late_Night +
Young_Driver + Poor_Lighting + Alcohol_Use + Bad_Weather,
data = dat, method = "logistic")
# Model summary and fit stats
summary(m2_logit)
logLik(m2_logit)
# Comparison with base model
m1_logit <- polr(Injury_Severity ~ Speed.Limit.at.Crash.Site + Urban +
Pedestrian + Parked_Vehicle + Late_Night,
data = dat, method = "logistic")
AIC(m1_logit); BIC(m1_logit); logLik(m1_logit)
AIC(m2_logit); BIC(m2_logit); logLik(m2_logit)
setwd("C:/Users/Hp/Downloads/CE687_Lab_Ordered_Response_52bc21f3-b49e-4afc-9c77-09d21dac5835")
# Load required packages
library(tidyverse)
library(MASS)
# Load data
dat <- read.csv("Michigan_Motorcycle_Non_Intersection_Data_Subset.csv", stringsAsFactors = TRUE)
# Construct ordered factor for injury severity
dat$Injury_Severity <- NA
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "No Injury (O)"] <- 0
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Possible Injury (C)"] <- 1
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Minor Injury (B)"] <- 2
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Serious Injury (A)"] <- 3
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Fatal Injury (K)"] <- 4
dat$Injury_Severity <- factor(dat$Injury_Severity, ordered = TRUE)
# Remove rows with NA in Injury_Severity
dat <- dat[!is.na(dat$Injury_Severity), ]
# Create binary explanatory variables
dat$Urban <- as.numeric(dat$Rural.Urban.Area == "Urban")
dat$Pedestrian <- as.numeric(dat$Crash..Pedestrian == "Pedestrian Involved")
dat$Late_Night <- as.numeric(dat$Time.of.Day %in% c(
"12:00 Midnight - 12:59 AM",
"1:00 AM - 1:59 AM",
"2:00 AM - 2:59 AM",
"3:00 AM - 3:59 AM",
"4:00 AM - 4:59 AM"
))
dat$Parked_Vehicle <- as.numeric(dat$Crash..Lane.Departure == "Parked Vehicle")
# New variables
dat$Young_Driver <- as.numeric(dat$Crash..Young.Driver == "Yes")
dat$Poor_Lighting <- as.numeric(dat$Lighting.Conditions %in% c(
"Dark - No Street Lights",
"Dark - Street Lights Not Functioning"
))
dat$Alcohol_Use <- as.numeric(dat$Crash..Drinking == "Yes")
dat$Bad_Weather <- as.numeric(dat$Weather.Conditions %in% c(
"Rain", "Snow", "Fog", "Sleet/Hail", "Other"
))
# Remove rows with NA in selected model variables
model_vars <- c("Injury_Severity", "Speed.Limit.at.Crash.Site", "Urban", "Pedestrian",
"Parked_Vehicle", "Late_Night", "Young_Driver",
"Poor_Lighting", "Alcohol_Use", "Bad_Weather")
dat_clean <- dat[complete.cases(dat[, model_vars]), model_vars]
# Fit ordered logit model
m2_logit <- polr(Injury_Severity ~ Speed.Limit.at.Crash.Site + Urban +
Pedestrian + Parked_Vehicle + Late_Night +
Young_Driver + Poor_Lighting + Alcohol_Use + Bad_Weather,
data = dat_clean, method = "logistic")
# View model summary and log-likelihood
summary(m2_logit)
# Load libraries
setwd("C:/Users/Hp/Downloads/CE687_Lab_Ordered_Response_52bc21f3-b49e-4afc-9c77-09d21dac5835")
library(tidyverse)
library(MASS)
# Load data
dat <- read.csv("Michigan_Motorcycle_Non_Intersection_Data_Subset.csv", stringsAsFactors = TRUE)
# Define Injury_Severity (ordered response variable)
dat$Injury_Severity <- 0
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Possible Injury (C)"] <- 1
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Minor Injury (B)"] <- 2
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Serious Injury (A)"] <- 3
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Fatal Injury (K)"] <- 4
dat$Injury_Severity <- as.factor(dat$Injury_Severity)
# Original explanatory variables
dat$Urban <- as.numeric(dat$Rural.Urban.Area == "Urban")
dat$Pedestrian <- as.numeric(dat$Crash..Pedestrian == "Pedestrian Involved")
dat$Late_Night <- as.numeric(dat$Time.of.Day %in% c("12:00 Midnight - 12:59 AM", "1:00 AM - 1:59 AM",
"2:00 AM - 2:59 AM", "3:00 AM - 3:59 AM",
"4:00 AM - 4:59 AM"))
dat$Parked_Vehicle <- as.numeric(dat$Crash..Lane.Departure == "Parked Vehicle")
#New explanatory variables from Question 1
dat$Num_Lanes <- dat$Number.of.Traffic.Lanes
dat$Young_Driver <- as.numeric(dat$Crash..Young.Driver== "yes"))
# Load libraries
setwd("C:/Users/Hp/Downloads/CE687_Lab_Ordered_Response_52bc21f3-b49e-4afc-9c77-09d21dac5835")
library(tidyverse)
library(MASS)
# Load data
dat <- read.csv("Michigan_Motorcycle_Non_Intersection_Data_Subset.csv", stringsAsFactors = TRUE)
# Define Injury_Severity (ordered response variable)
dat$Injury_Severity <- 0
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Possible Injury (C)"] <- 1
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Minor Injury (B)"] <- 2
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Serious Injury (A)"] <- 3
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Fatal Injury (K)"] <- 4
dat$Injury_Severity <- as.factor(dat$Injury_Severity)
# Original explanatory variables
dat$Urban <- as.numeric(dat$Rural.Urban.Area == "Urban")
dat$Pedestrian <- as.numeric(dat$Crash..Pedestrian == "Pedestrian Involved")
dat$Late_Night <- as.numeric(dat$Time.of.Day %in% c("12:00 Midnight - 12:59 AM", "1:00 AM - 1:59 AM",
"2:00 AM - 2:59 AM", "3:00 AM - 3:59 AM",
"4:00 AM - 4:59 AM"))
dat$Parked_Vehicle <- as.numeric(dat$Crash..Lane.Departure == "Parked Vehicle")
#New explanatory variables from Question 1
dat$Num_Lanes <- dat$Number.of.Traffic.Lanes
dat$Young_Driver <- as.numeric(dat$Crash..Young.Driver== "Yes"))
# Load libraries
setwd("C:/Users/Hp/Downloads/CE687_Lab_Ordered_Response_52bc21f3-b49e-4afc-9c77-09d21dac5835")
library(tidyverse)
library(MASS)
# Load data
dat <- read.csv("Michigan_Motorcycle_Non_Intersection_Data_Subset.csv", stringsAsFactors = TRUE)
# Define Injury_Severity (ordered response variable)
dat$Injury_Severity <- 0
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Possible Injury (C)"] <- 1
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Minor Injury (B)"] <- 2
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Serious Injury (A)"] <- 3
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Fatal Injury (K)"] <- 4
dat$Injury_Severity <- as.factor(dat$Injury_Severity)
# Original explanatory variables
dat$Urban <- as.numeric(dat$Rural.Urban.Area == "Urban")
dat$Pedestrian <- as.numeric(dat$Crash..Pedestrian == "Pedestrian Involved")
dat$Late_Night <- as.numeric(dat$Time.of.Day %in% c("12:00 Midnight - 12:59 AM", "1:00 AM - 1:59 AM",
"2:00 AM - 2:59 AM", "3:00 AM - 3:59 AM",
"4:00 AM - 4:59 AM"))
dat$Parked_Vehicle <- as.numeric(dat$Crash..Lane.Departure == "Parked Vehicle")
#New explanatory variables from Question 1
dat$Num_Lanes <- dat$Number.of.Traffic.Lanes
dat$Young_Driver <- as.numeric(dat$Crash..Young.Driver %in% c("Driver Age 15-24", "Driver Age 16",
"Driver Age 17", "Driver Age 18-20",
"Driver Age 21-24"))
dat$Alcohol_Use <- as.numeric(dat$Crash..Drinking == "Yes")
# Fit the updated ordered probit model
m1_probit <- polr(Injury_Severity ~ Speed.Limit.at.Crash.Site + Urban + Pedestrian +
Parked_Vehicle + Late_Night + Num_Lanes + Young_Driver + Alcohol_Use,
data = dat, method = "probit")
# Display model summary
summary(m1_probit)
# Load libraries
library(tidyverse)
library(MASS)
# Load data
dat <- read.csv("Michigan_Motorcycle_Non_Intersection_Data_Subset.csv", stringsAsFactors = TRUE)
# Prepare Injury_Severity (ordered factor)
dat$Injury_Severity <- NA
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Possible Injury (C)"] <- 1
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Minor Injury (B)"] <- 2
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Serious Injury (A)"] <- 3
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Fatal Injury (K)"] <- 4
dat$Injury_Severity <- factor(dat$Injury_Severity, ordered = TRUE)
# Drop unused levels
dat <- droplevels(dat)
# Remove rows with NA in target variable
dat <- dat[!is.na(dat$Injury_Severity), ]
# Explanatory variables
dat$Urban <- as.numeric(dat$Rural.Urban.Area == "Urban")
dat$Pedestrian <- as.numeric(dat$Crash..Pedestrian == "Pedestrian Involved")
dat$Late_Night <- as.numeric(dat$Time.of.Day %in% c(
"12:00 Midnight - 12:59 AM", "1:00 AM - 1:59 AM",
"2:00 AM - 2:59 AM", "3:00 AM - 3:59 AM",
"4:00 AM - 4:59 AM"
))
dat$Parked_Vehicle <- as.numeric(dat$Crash..Lane.Departure == "Parked Vehicle")
dat$Num_Lanes <- dat$Number.of.Traffic.Lanes
dat$Young_Driver <- as.numeric(dat$Crash..Young.Driver %in% c(
"Driver Age 15-24", "Driver Age 16", "Driver Age 17",
"Driver Age 18-20", "Driver Age 21-24"
))
dat$Alcohol_Use <- as.numeric(dat$Crash..Drinking == "Yes")
# Fit ordered probit model
m1_probit <- polr(Injury_Severity ~ Speed.Limit.at.Crash.Site + Urban + Pedestrian +
Parked_Vehicle + Late_Night + Num_Lanes + Young_Driver + Alcohol_Use,
data = dat, method = "probit")
summary(m1_probit)
# Load libraries
library(tidyverse)
library(MASS)
# Load data
dat <- read.csv("Michigan_Motorcycle_Non_Intersection_Data_Subset.csv", stringsAsFactors = TRUE)
# Prepare Injury_Severity (ordered factor)
dat$Injury_Severity <- NA
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Possible Injury (C)"] <- 1
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Minor Injury (B)"] <- 2
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Serious Injury (A)"] <- 3
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Fatal Injury (K)"] <- 4
dat$Injury_Severity <- factor(dat$Injury_Severity, ordered = TRUE)
# Drop unused levels
dat <- droplevels(dat)
# Remove rows with NA in target variable
dat <- dat[!is.na(dat$Injury_Severity), ]
# Explanatory variables
dat$Urban <- as.numeric(dat$Rural.Urban.Area == "Urban")
dat$Pedestrian <- as.numeric(dat$Crash..Pedestrian == "Pedestrian Involved")
dat$Late_Night <- as.numeric(dat$Time.of.Day %in% c(
"12:00 Midnight - 12:59 AM", "1:00 AM - 1:59 AM",
"2:00 AM - 2:59 AM", "3:00 AM - 3:59 AM",
"4:00 AM - 4:59 AM"
))
dat$Parked_Vehicle <- as.numeric(dat$Crash..Lane.Departure == "Parked Vehicle")
dat$Num_Lanes <- dat$Number.of.Traffic.Lanes
dat$Young_Driver <- as.numeric(dat$Crash..Young.Driver %in% c(
"Driver Age 15-24", "Driver Age 16", "Driver Age 17",
"Driver Age 18-20", "Driver Age 21-24"
))
dat$Alcohol_Use <- as.numeric(dat$Crash..Drinking == "Yes")
# Fit ordered probit model
m1_probit <- polr(Injury_Severity ~ Speed.Limit.at.Crash.Site + Urban + Pedestrian +
Parked_Vehicle + Late_Night + Num_Lanes + Young_Driver + Alcohol_Use,
data = dat, method = "probit")
summary(m1_probit)
# Set working directory
setwd("C:/Users/Hp/Downloads/CE687_Lab_Ordered_Response_52bc21f3-b49e-4afc-9c77-09d21dac5835")
# Load libraries
library(tidyverse)
library(MASS)
# Load dataset
dat <- read.csv("Michigan_Motorcycle_Non_Intersection_Data_Subset.csv", stringsAsFactors = TRUE)
#  1. Define Injury_Severity with ALL 5 categories
dat$Injury_Severity <- NA
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "No Injury (O)"] <- 0
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Possible Injury (C)"] <- 1
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Minor Injury (B)"] <- 2
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Serious Injury (A)"] <- 3
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Fatal Injury (K)"] <- 4
dat$Injury_Severity <- factor(dat$Injury_Severity, ordered = TRUE)
#  2. Create explanatory variables
dat$Urban <- as.numeric(dat$Rural.Urban.Area == "Urban")
dat$Pedestrian <- as.numeric(dat$Crash..Pedestrian == "Pedestrian Involved")
dat$Late_Night <- as.numeric(dat$Time.of.Day %in% c(
"12:00 Midnight - 12:59 AM", "1:00 AM - 1:59 AM",
"2:00 AM - 2:59 AM", "3:00 AM - 3:59 AM", "4:00 AM - 4:59 AM"
))
dat$Parked_Vehicle <- as.numeric(dat$Crash..Lane.Departure == "Parked Vehicle")
dat$Num_Lanes <- dat$Number.of.Traffic.Lanes
dat$Young_Driver <- as.numeric(dat$Crash..Young.Driver %in% c(
"Driver Age 15-24", "Driver Age 16", "Driver Age 17",
"Driver Age 18-20", "Driver Age 21-24", "Driver Age 15"
))
dat$Alcohol_Use <- as.numeric(dat$Crash..Drinking == "Drinking Involved")
#  3. Remove rows with any NA in model variables
model_vars <- c("Injury_Severity", "Speed.Limit.at.Crash.Site", "Urban", "Pedestrian",
"Parked_Vehicle", "Late_Night", "Num_Lanes", "Young_Driver", "Alcohol_Use")
dat_clean <- dat[complete.cases(dat[, model_vars]), model_vars]
# 4. Fit Ordered Probit Model
m1_probit <- polr(Injury_Severity ~ Speed.Limit.at.Crash.Site + Urban + Pedestrian +
Parked_Vehicle + Late_Night + Num_Lanes + Young_Driver + Alcohol_Use,
data = dat_clean, method = "probit")
summary(m1_probit)
###set working directory (change it to where you have downloaded the file and code)
setwd("C:/Users/Hp/Downloads/CE687_Lab_Ordered_Response_52bc21f3-b49e-4afc-9c77-09d21dac5835")
library(tidyverse)
library(MASS)
######crash data#########
dat<-read.csv("Michigan_Motorcycle_Non_Intersection_Data_Subset.csv",stringsAsFactors = T)
colnames(dat)
summary(dat)
####Some of the variables may be described in Michigan's coding manual for crash reports
# https://www.michigan.gov/msp/-/media/Project/Websites/msp/cjic/Traffic-Crash-Reporting-Unit-Files/2022-Manual-FINAL.pdf?rev=cb7f9a6b4c6a4a9b9c572508154e84eb
###Create an ordered response variable, injury severity
###0 - No Injury (O)
###1 - Possible Injury (C)
###2 - Suspected Minor Injury (B)
###3 - Suspected Serious Injury (A)
###4 - Fatal Injury (K)
dat$Injury_Severity<-0
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Possible Injury (C)"]<-1
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Minor Injury (B)"]<-2
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Suspected Serious Injury (A)"]<-3
dat$Injury_Severity[dat$Worst.Injury.in.Crash == "Fatal Injury (K)"]<-4
dat$Injury_Severity<-as.factor(dat$Injury_Severity)
summary(dat$Injury_Severity)
###Creating explanatory variables
dat$Urban<-as.numeric(dat$Rural.Urban.Area=="Urban")
dat$Pedestrian<-as.numeric(dat$Crash..Pedestrian=="Pedestrian Involved")
dat$Late_Night<-as.numeric(dat$Time.of.Day=="12:00 Midnight - 12:59 AM" |
dat$Time.of.Day=="1:00 AM - 1:59 AM" |
dat$Time.of.Day=="2:00 AM - 2:59 AM" |
dat$Time.of.Day=="3:00 AM - 3:59 AM" |
dat$Time.of.Day=="4:00 AM - 4:59 AM")
dat$Parked_Vehicle<-as.numeric(dat$Crash..Lane.Departure=="Parked Vehicle")
###Probit model
m1_probit <- polr(Injury_Severity~Speed.Limit.at.Crash.Site+Urban+
Pedestrian + Parked_Vehicle + Late_Night
,
data=dat,method="probit")
summary(m1_probit)
logLik(m1_probit)
###Probit model
m1_logit <- polr(Injury_Severity~Speed.Limit.at.Crash.Site+Urban+
Pedestrian + Parked_Vehicle + Late_Night
,
data=dat,method="logistic")
